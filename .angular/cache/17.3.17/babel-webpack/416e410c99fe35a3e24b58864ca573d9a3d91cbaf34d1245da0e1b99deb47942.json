{"ast":null,"code":"import { ElementRef } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MOCK_STUDENTS, MOCK_TEACHERS } from '../constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nconst _c0 = (a0, a1) => ({\n  \"bg-orange-50 text-orange-700 border-orange-200 hover:bg-orange-100\": a0,\n  \"bg-white text-gray-600 border-gray-300 hover:bg-gray-50\": a1\n});\nconst _c1 = (a0, a1, a2) => ({\n  \"bg-green-50 border-green-200 text-green-800\": a0,\n  \"bg-yellow-50 border-yellow-200 text-yellow-800\": a1,\n  \"bg-red-50 border-red-200 text-red-800\": a2\n});\nconst _c2 = (a0, a1, a2) => ({\n  \"text-green-500\": a0,\n  \"text-yellow-500\": a1,\n  \"text-red-500\": a2\n});\nconst _c3 = a0 => ({\n  \"bg-blue-50\": a0\n});\nconst _c4 = a0 => ({\n  \"cursor-pointer hover:opacity-80\": a0\n});\nconst _c5 = (a0, a1) => ({\n  \"bg-blue-50 border-blue-300 shadow-sm\": a0,\n  \"bg-white border-transparent hover:bg-gray-50\": a1\n});\nconst _c6 = (a0, a1) => ({\n  \"bg-blue-600 border-blue-600 text-white\": a0,\n  \"border-gray-300 bg-white\": a1\n});\nconst _c7 = (a0, a1) => ({\n  \"text-blue-900\": a0,\n  \"text-gray-700\": a1\n});\nfunction TeacherAssignmentComponent_div_1__svg_svg_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"svg\", 80);\n    i0.ɵɵelement(1, \"path\", 81)(2, \"polyline\", 82);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TeacherAssignmentComponent_div_1__svg_svg_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"svg\", 80);\n    i0.ɵɵelement(1, \"path\", 83)(2, \"line\", 84)(3, \"line\", 85);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TeacherAssignmentComponent_div_1__svg_svg_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"svg\", 80);\n    i0.ɵɵelement(1, \"circle\", 86)(2, \"line\", 87)(3, \"line\", 88);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TeacherAssignmentComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 73)(1, \"div\", 74);\n    i0.ɵɵtemplate(2, TeacherAssignmentComponent_div_1__svg_svg_2_Template, 3, 0, \"svg\", 75)(3, TeacherAssignmentComponent_div_1__svg_svg_3_Template, 4, 0, \"svg\", 75)(4, TeacherAssignmentComponent_div_1__svg_svg_4_Template, 4, 0, \"svg\", 75);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 76);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"button\", 77);\n    i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_div_1_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.showToast = false);\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(8, \"svg\", 65);\n    i0.ɵɵelement(9, \"line\", 78)(10, \"line\", 79);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(6, _c1, ctx_r1.toastType === \"success\", ctx_r1.toastType === \"warning\", ctx_r1.toastType === \"error\"));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(10, _c2, ctx_r1.toastType === \"success\", ctx_r1.toastType === \"warning\", ctx_r1.toastType === \"error\"));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.toastType === \"success\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.toastType === \"warning\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.toastType === \"error\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.toastMessage);\n  }\n}\nfunction TeacherAssignmentComponent_tr_72_ng_container_12_span_1_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 100);\n    i0.ɵɵtext(1, \"CN\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TeacherAssignmentComponent_tr_72_ng_container_12_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 98)(1, \"span\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, TeacherAssignmentComponent_tr_72_ng_container_12_span_1_span_3_Template, 2, 0, \"span\", 99);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const t_r5 = ctx.$implicit;\n    const student_r4 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵproperty(\"ngClass\", student_r4.homeroomTeacherId === t_r5.id ? \"bg-red-100 text-red-800 border border-red-200\" : \"bg-blue-100 text-blue-800 border border-blue-200\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(t_r5.shortName);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", student_r4.homeroomTeacherId === t_r5.id);\n  }\n}\nfunction TeacherAssignmentComponent_tr_72_ng_container_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, TeacherAssignmentComponent_tr_72_ng_container_12_span_1_Template, 4, 3, \"span\", 97);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const student_r4 = i0.ɵɵnextContext().$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.getAssignedTeachers(student_r4));\n  }\n}\nfunction TeacherAssignmentComponent_tr_72_ng_template_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 101);\n    i0.ɵɵtext(1, \"-\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TeacherAssignmentComponent_tr_72_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 89)(1, \"td\", 90);\n    i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_tr_72_Template_td_click_1_listener() {\n      const student_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleStudent(student_r4.id));\n    });\n    i0.ɵɵelementStart(2, \"input\", 43);\n    i0.ɵɵlistener(\"change\", function TeacherAssignmentComponent_tr_72_Template_input_change_2_listener() {\n      const student_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleStudent(student_r4.id));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(3, \"td\", 90);\n    i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_tr_72_Template_td_click_3_listener() {\n      const student_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleStudent(student_r4.id));\n    });\n    i0.ɵɵelementStart(4, \"div\", 91);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 92);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"td\", 93);\n    i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_tr_72_Template_td_click_8_listener() {\n      const student_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleStudent(student_r4.id));\n    });\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\", 94)(11, \"div\", 95);\n    i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_tr_72_Template_div_click_11_listener() {\n      const student_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.openTeacherDetails(student_r4));\n    });\n    i0.ɵɵtemplate(12, TeacherAssignmentComponent_tr_72_ng_container_12_Template, 2, 1, \"ng-container\", 96)(13, TeacherAssignmentComponent_tr_72_ng_template_13_Template, 2, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const student_r4 = ctx.$implicit;\n    const noTeacher_r6 = i0.ɵɵreference(14);\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(8, _c3, ctx_r1.selectedStudentIds.has(student_r4.id)));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", ctx_r1.selectedStudentIds.has(student_r4.id));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(student_r4.fullName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(student_r4.code);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", student_r4.className, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(10, _c4, ctx_r1.getAssignedTeachers(student_r4).length > 0));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.getAssignedTeachers(student_r4).length > 0)(\"ngIfElse\", noTeacher_r6);\n  }\n}\nfunction TeacherAssignmentComponent_tr_73_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 102);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.showUnassignedOnly ? \"Tuy\\u1EC7t v\\u1EDDi! T\\u1EA5t c\\u1EA3 h\\u1ECDc sinh \\u0111\\u1EC1u \\u0111\\u00E3 c\\u00F3 gi\\u00E1o vi\\u00EAn.\" : \"Kh\\u00F4ng t\\u00ECm th\\u1EA5y h\\u1ECDc sinh ph\\u00F9 h\\u1EE3p\", \" \");\n  }\n}\nfunction TeacherAssignmentComponent_label_91__svg_svg_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"svg\", 111);\n    i0.ɵɵelement(1, \"polyline\", 112);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TeacherAssignmentComponent_label_91_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"label\", 103)(1, \"input\", 104);\n    i0.ɵɵlistener(\"change\", function TeacherAssignmentComponent_label_91_Template_input_change_1_listener() {\n      const teacher_r8 = i0.ɵɵrestoreView(_r7).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.toggleTeacherSelection(teacher_r8.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"div\", 105);\n    i0.ɵɵtemplate(3, TeacherAssignmentComponent_label_91__svg_svg_3_Template, 2, 0, \"svg\", 106);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 107)(5, \"div\", 108);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 109);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 110);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const teacher_r8 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(8, _c5, ctx_r1.isTeacherSelected(teacher_r8.id), !ctx_r1.isTeacherSelected(teacher_r8.id)));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"checked\", ctx_r1.isTeacherSelected(teacher_r8.id));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(11, _c6, ctx_r1.isTeacherSelected(teacher_r8.id), !ctx_r1.isTeacherSelected(teacher_r8.id)));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isTeacherSelected(teacher_r8.id));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(14, _c7, ctx_r1.isTeacherSelected(teacher_r8.id), !ctx_r1.isTeacherSelected(teacher_r8.id)));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(teacher_r8.shortName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(teacher_r8.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"ID: \", teacher_r8.cccd.slice(-4), \"\");\n  }\n}\nfunction TeacherAssignmentComponent_div_92_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 113);\n    i0.ɵɵtext(1, \" Kh\\u00F4ng t\\u00ECm th\\u1EA5y gi\\u00E1o vi\\u00EAn \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TeacherAssignmentComponent_div_123_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 126)(1, \"div\", 127);\n    i0.ɵɵelement(2, \"img\", 128);\n    i0.ɵɵelementStart(3, \"div\")(4, \"h4\", 129);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"span\", 130);\n    i0.ɵɵtext(7, \"\\u0110ang d\\u1EA1y\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(8, \"div\", 131)(9, \"div\", 132)(10, \"span\", 133);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(11, \"svg\", 65);\n    i0.ɵɵelement(12, \"rect\", 134)(13, \"line\", 135)(14, \"line\", 136)(15, \"line\", 137);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(16, \"span\");\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"span\", 138);\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"div\", 132)(21, \"span\", 133);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(22, \"svg\", 65);\n    i0.ɵɵelement(23, \"rect\", 139)(24, \"path\", 140)(25, \"path\", 141)(26, \"path\", 142);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(27, \"span\", 143);\n    i0.ɵɵtext(28);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(29, \"div\", 132)(30, \"span\", 133);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(31, \"svg\", 65);\n    i0.ɵɵelement(32, \"path\", 144);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(33, \"span\");\n    i0.ɵɵtext(34);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(35, \"div\", 145)(36, \"span\", 146);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(37, \"svg\", 65);\n    i0.ɵɵelement(38, \"path\", 147)(39, \"circle\", 148);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(40, \"span\", 149);\n    i0.ɵɵtext(41);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(42, \"div\", 150)(43, \"button\", 151);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(44, \"svg\", 65);\n    i0.ɵɵelement(45, \"path\", 144);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(46, \" G\\u1ECDi \\u0111i\\u1EC7n \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const teacher_r10 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", teacher_r10.avatar, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(teacher_r10.name);\n    i0.ɵɵadvance(12);\n    i0.ɵɵtextInterpolate(teacher_r10.dob);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(teacher_r10.gender);\n    i0.ɵɵadvance(9);\n    i0.ɵɵtextInterpolate1(\"CCCD: \", teacher_r10.cccd, \"\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(teacher_r10.phone);\n    i0.ɵɵadvance(6);\n    i0.ɵɵpropertyInterpolate(\"title\", teacher_r10.address);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(teacher_r10.address);\n  }\n}\nfunction TeacherAssignmentComponent_div_123_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 114)(1, \"div\", 115);\n    i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_div_123_Template_div_click_1_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.closeTeacherDetails());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"div\", 116)(3, \"div\", 117)(4, \"div\")(5, \"h3\", 118);\n    i0.ɵɵtext(6, \"Gi\\u00E1o vi\\u00EAn ph\\u1EE5 tr\\u00E1ch\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\", 119);\n    i0.ɵɵtext(8, \"H\\u1ECDc sinh: \");\n    i0.ɵɵelementStart(9, \"span\", 120);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"button\", 121);\n    i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_div_123_Template_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.closeTeacherDetails());\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(12, \"svg\", 122);\n    i0.ɵɵelement(13, \"line\", 78)(14, \"line\", 79);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(15, \"div\", 123)(16, \"div\", 124);\n    i0.ɵɵtemplate(17, TeacherAssignmentComponent_div_123_div_17_Template, 47, 8, \"div\", 125);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(10);\n    i0.ɵɵtextInterpolate(ctx_r1.viewingStudentDetails.fullName);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.viewingTeachers);\n  }\n}\nexport let TeacherAssignmentComponent = /*#__PURE__*/(() => {\n  class TeacherAssignmentComponent {\n    constructor(elementRef) {\n      this.elementRef = elementRef;\n      // Use MOCK_STUDENTS direct reference to ensure synchronization across modules\n      this.students = MOCK_STUDENTS;\n      this.teachers = MOCK_TEACHERS;\n      this.filteredStudents = [];\n      this.filteredTeachers = [];\n      // ... rest of the code remains same, logic for references is updated by removing JSON.parse/stringify ...\n      this.selectedStudentIds = new Set();\n      this.selectedTeacherIds = new Set();\n      // Filter States\n      this.studentSearchTerm = '';\n      this.classFilter = '';\n      this.teacherSearchTerm = '';\n      // New state for unassigned filter\n      this.showUnassignedOnly = false;\n      // If true, applied teacher(s) will set homeroom for selected students\n      this.assignAsHomeroom = false;\n      // Modal State\n      this.viewingStudentDetails = null;\n      this.viewingTeachers = [];\n      // Toast Notification State\n      this.showToast = false;\n      this.toastMessage = '';\n      this.toastType = 'success';\n      this.applyStudentFilters();\n      this.filteredTeachers = [...this.teachers];\n    }\n    // Helper to show notification\n    showNotification(message, type = 'success') {\n      this.toastMessage = message;\n      this.toastType = type;\n      this.showToast = true;\n      setTimeout(() => {\n        this.showToast = false;\n      }, 3000);\n    }\n    // Helper to count total unassigned students\n    get unassignedCount() {\n      return this.students.filter(s => !s.assignedTeacherIds || s.assignedTeacherIds.length === 0).length;\n    }\n    toggleUnassignedFilter() {\n      this.showUnassignedOnly = !this.showUnassignedOnly;\n      this.applyStudentFilters();\n    }\n    // --- Student Filters ---\n    onStudentSearch(event) {\n      this.studentSearchTerm = event.target.value.toLowerCase();\n      this.applyStudentFilters();\n    }\n    onClassFilterChange(event) {\n      this.classFilter = event.target.value;\n      this.applyStudentFilters();\n    }\n    getClassPriority(className) {\n      if (className.includes('Mầm')) return 1;\n      if (className.includes('Chồi')) return 2;\n      if (className.includes('Lá')) return 3;\n      if (className.includes('6-18')) return 4;\n      if (className.includes('19-24')) return 5;\n      if (className.includes('25-36')) return 6;\n      return 99; // Các lớp khác (nếu có)\n    }\n    applyStudentFilters() {\n      // 1. Filter\n      let result = this.students.filter(s => {\n        const matchesSearch = s.fullName.toLowerCase().includes(this.studentSearchTerm) || s.code.toLowerCase().includes(this.studentSearchTerm);\n        const matchesClass = this.classFilter ? s.className.includes(this.classFilter) : true;\n        const isUnassigned = !s.assignedTeacherIds || s.assignedTeacherIds.length === 0;\n        const matchesUnassigned = this.showUnassignedOnly ? isUnassigned : true;\n        return matchesSearch && matchesClass && matchesUnassigned;\n      });\n      // 2. Sort: Mầm -> Chồi -> Lá -> 6-18 -> 19-24 -> 25-36\n      result.sort((a, b) => {\n        const priorityA = this.getClassPriority(a.className);\n        const priorityB = this.getClassPriority(b.className);\n        if (priorityA !== priorityB) {\n          return priorityA - priorityB;\n        }\n        return a.className.localeCompare(b.className);\n      });\n      this.filteredStudents = result;\n    }\n    // --- Teacher Search ---\n    onTeacherSearch(event) {\n      this.teacherSearchTerm = event.target.value.toLowerCase();\n      this.filteredTeachers = this.teachers.filter(t => t.name.toLowerCase().includes(this.teacherSearchTerm) || t.shortName.toLowerCase().includes(this.teacherSearchTerm) || t.cccd.includes(this.teacherSearchTerm));\n    }\n    // --- Student Selection Logic ---\n    toggleStudent(id) {\n      if (this.selectedStudentIds.has(id)) {\n        this.selectedStudentIds.delete(id);\n      } else {\n        this.selectedStudentIds.add(id);\n      }\n    }\n    toggleSelectAll() {\n      if (this.isAllSelected()) {\n        this.selectedStudentIds.clear();\n      } else {\n        this.filteredStudents.forEach(s => this.selectedStudentIds.add(s.id));\n      }\n    }\n    isAllSelected() {\n      return this.filteredStudents.length > 0 && this.selectedStudentIds.size === this.filteredStudents.length;\n    }\n    // --- Teacher Selection Logic ---\n    toggleTeacherSelection(teacherId) {\n      if (this.selectedTeacherIds.has(teacherId)) {\n        this.selectedTeacherIds.delete(teacherId);\n      } else {\n        this.selectedTeacherIds.add(teacherId);\n      }\n    }\n    isTeacherSelected(teacherId) {\n      return this.selectedTeacherIds.has(teacherId);\n    }\n    // --- Main Actions ---\n    applyAssignment() {\n      if (this.selectedStudentIds.size === 0 || this.selectedTeacherIds.size === 0) return;\n      const teachersToAdd = Array.from(this.selectedTeacherIds);\n      // If assigning as homeroom, ensure only one teacher is selected\n      if (this.assignAsHomeroom && teachersToAdd.length > 1) {\n        this.showNotification('Chỉ có thể chọn 1 giáo viên làm chủ nhiệm. Vui lòng chọn 1 giáo viên.', 'warning');\n        return;\n      }\n      let countSuccess = 0;\n      this.students.forEach(student => {\n        if (this.selectedStudentIds.has(student.id)) {\n          if (!student.assignedTeacherIds) student.assignedTeacherIds = [];\n          let added = false;\n          for (const newId of teachersToAdd) {\n            // If not assigning as homeroom and the teacher is already the student's homeroom, warn and skip\n            if (!this.assignAsHomeroom && student.homeroomTeacherId && newId === student.homeroomTeacherId) {\n              const teacher = this.teachers.find(t => t.id === newId);\n              if (teacher) {\n                this.showNotification(`Giáo viên ${teacher.shortName} đã được phân làm giáo viên chủ nhiệm cho học sinh ${student.fullName}.`, 'warning');\n              }\n              continue;\n            }\n            if (!student.assignedTeacherIds.includes(newId)) {\n              student.assignedTeacherIds.push(newId);\n              added = true;\n            }\n          }\n          // If assigning as homeroom, set homeroomTeacherId to the first selected teacher\n          if (this.assignAsHomeroom && teachersToAdd.length > 0) {\n            // pick first selected teacher as homeroom\n            student.homeroomTeacherId = teachersToAdd[0];\n            // ensure homeroom teacher is included in assignedTeacherIds\n            if (!student.assignedTeacherIds.includes(teachersToAdd[0])) {\n              student.assignedTeacherIds.push(teachersToAdd[0]);\n              added = true;\n            }\n          }\n          if (added) countSuccess++;\n        }\n      });\n      this.applyStudentFilters(); // Refresh UI\n      this.selectedTeacherIds.clear(); // Reset Teacher checkboxes\n      this.selectedStudentIds.clear(); // Reset Student checkboxes\n      // Reset the homeroom assignment toggle after applying\n      this.assignAsHomeroom = false;\n      this.showNotification(`Đã phân công thành công cho ${countSuccess} học sinh!`, 'success');\n    }\n    removeAssignment() {\n      if (this.selectedStudentIds.size === 0 || this.selectedTeacherIds.size === 0) return;\n      const teachersToRemove = Array.from(this.selectedTeacherIds);\n      let changeCount = 0;\n      this.students.forEach(student => {\n        if (this.selectedStudentIds.has(student.id) && student.assignedTeacherIds) {\n          const originalLength = student.assignedTeacherIds.length;\n          student.assignedTeacherIds = student.assignedTeacherIds.filter(existingId => !teachersToRemove.includes(existingId));\n          // If homeroom teacher removed, clear homeroomTeacherId\n          if (student.homeroomTeacherId && teachersToRemove.includes(student.homeroomTeacherId)) {\n            student.homeroomTeacherId = undefined;\n          }\n          if (student.assignedTeacherIds.length !== originalLength) {\n            changeCount++;\n          }\n        }\n      });\n      if (changeCount === 0) {\n        this.showNotification('Các học sinh đã chọn chưa được phân công bởi giáo viên này.', 'warning');\n        return;\n      }\n      this.applyStudentFilters(); // Refresh UI\n      this.selectedTeacherIds.clear(); // Reset Teacher checkboxes\n      this.selectedStudentIds.clear(); // Reset Student checkboxes\n      this.showNotification(`Đã gỡ phân công thành công cho ${changeCount} học sinh.`, 'success');\n    }\n    // --- Helpers ---\n    getAssignedTeachers(student) {\n      if (!student.assignedTeacherIds) return [];\n      return this.teachers.filter(t => student.assignedTeacherIds.includes(t.id));\n    }\n    // --- Details Modal Logic ---\n    openTeacherDetails(student) {\n      const assigned = this.getAssignedTeachers(student);\n      if (assigned.length === 0) return;\n      this.viewingStudentDetails = student;\n      this.viewingTeachers = assigned;\n    }\n    closeTeacherDetails() {\n      this.viewingStudentDetails = null;\n      this.viewingTeachers = [];\n    }\n    static {\n      this.ɵfac = function TeacherAssignmentComponent_Factory(t) {\n        return new (t || TeacherAssignmentComponent)(i0.ɵɵdirectiveInject(ElementRef));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: TeacherAssignmentComponent,\n        selectors: [[\"app-teacher-assignment\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 124,\n        vars: 21,\n        consts: [[\"noTeacher\", \"\"], [1, \"flex\", \"flex-col\", \"lg:flex-row\", \"gap-6\", \"h-[calc(100vh-140px)]\", \"relative\"], [\"class\", \"absolute top-4 left-1/2 -translate-x-1/2 z-50 flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg border animate-in fade-in slide-in-from-top-4 duration-300\", 3, \"ngClass\", 4, \"ngIf\"], [1, \"flex-1\", \"bg-white\", \"rounded-lg\", \"shadow-sm\", \"border\", \"border-gray-200\", \"flex\", \"flex-col\", \"overflow-hidden\"], [1, \"p-4\", \"border-b\", \"border-gray-200\", \"bg-gray-50\", \"flex\", \"flex-col\", \"gap-3\"], [1, \"flex\", \"items-center\", \"justify-between\"], [1, \"font-semibold\", \"text-gray-800\"], [1, \"flex\", \"items-center\", \"gap-3\"], [1, \"flex\", \"items-center\", \"gap-1.5\", \"px-3\", \"py-1\", \"rounded-full\", \"text-xs\", \"font-medium\", \"bg-blue-50\", \"text-blue-700\", \"border\", \"border-blue-100\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"14\", \"height\", \"14\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [\"d\", \"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\"], [\"cx\", \"9\", \"cy\", \"7\", \"r\", \"4\"], [\"d\", \"M22 21v-2a4 4 0 0 0-3-3.87\"], [\"d\", \"M16 3.13a4 4 0 0 1 0 7.75\"], [1, \"h-4\", \"w-px\", \"bg-gray-300\"], [1, \"flex\", \"items-center\", \"gap-2\", \"px-3\", \"py-1\", \"rounded-full\", \"text-xs\", \"font-medium\", \"border\", \"transition-colors\", \"shadow-sm\", 3, \"click\", \"ngClass\"], [1, \"w-2\", \"h-2\", \"rounded-full\", 3, \"ngClass\"], [1, \"text-xs\", \"text-gray-500\"], [1, \"font-bold\", \"text-blue-600\"], [1, \"flex\", \"gap-3\"], [1, \"relative\", \"w-40\"], [1, \"w-full\", \"pl-2\", \"pr-8\", \"py-1.5\", \"border\", \"border-gray-300\", \"rounded\", \"text-sm\", \"focus:ring-1\", \"focus:ring-blue-500\", \"outline-none\", \"appearance-none\", \"bg-white\", \"disabled:bg-gray-100\", \"disabled:text-gray-400\", 3, \"change\", \"disabled\"], [\"value\", \"\"], [\"label\", \"M\\u1EABu Gi\\u00E1o\"], [\"value\", \"M\\u1EA7m\"], [\"value\", \"Ch\\u1ED3i\"], [\"value\", \"L\\u00E1\"], [\"label\", \"Nh\\u00E0 Tr\\u1EBB\"], [\"value\", \"6-18\"], [\"value\", \"19-24\"], [\"value\", \"25-36\"], [1, \"absolute\", \"right-2\", \"top-1/2\", \"-translate-y-1/2\", \"pointer-events-none\", \"text-gray-400\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"12\", \"height\", \"12\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [\"d\", \"m6 9 6 6 6-6\"], [1, \"relative\", \"flex-1\"], [\"type\", \"text\", \"placeholder\", \"T\\u00ECm t\\u00EAn ho\\u1EB7c m\\u00E3 s\\u1ED1...\", 1, \"pl-9\", \"pr-4\", \"py-1.5\", \"w-full\", \"border\", \"border-gray-300\", \"rounded\", \"text-sm\", \"focus:ring-1\", \"focus:ring-blue-500\", \"outline-none\", 3, \"input\"], [1, \"absolute\", \"left-3\", \"top-1/2\", \"-translate-y-1/2\", \"text-gray-400\"], [\"cx\", \"11\", \"cy\", \"11\", \"r\", \"8\"], [\"d\", \"m21 21-4.3-4.3\"], [1, \"flex-1\", \"overflow-auto\"], [1, \"w-full\", \"text-left\", \"border-collapse\"], [1, \"bg-white\", \"sticky\", \"top-0\", \"z-10\", \"shadow-sm\", \"text-xs\", \"font-semibold\", \"text-gray-500\", \"uppercase\"], [1, \"px-4\", \"py-3\", \"border-b\", \"w-10\", \"bg-gray-50\"], [\"type\", \"checkbox\", 1, \"w-4\", \"h-4\", \"rounded\", \"border-gray-300\", \"text-blue-600\", \"focus:ring-blue-500\", \"cursor-pointer\", 3, \"change\", \"checked\"], [1, \"px-4\", \"py-3\", \"border-b\", \"bg-gray-50\"], [1, \"divide-y\", \"divide-gray-100\"], [\"class\", \"hover:bg-blue-50/40 transition-colors\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [1, \"w-full\", \"lg:w-80\", \"bg-white\", \"rounded-lg\", \"shadow-sm\", \"border\", \"border-gray-200\", \"flex\", \"flex-col\"], [1, \"p-4\", \"border-b\", \"border-gray-200\", \"bg-blue-50\", \"rounded-t-lg\"], [1, \"font-semibold\", \"text-blue-900\", \"flex\", \"items-center\", \"gap-2\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"18\", \"height\", \"18\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [1, \"mt-3\", \"relative\"], [\"type\", \"text\", \"placeholder\", \"T\\u00ECm t\\u00EAn ho\\u1EB7c CCCD...\", 1, \"w-full\", \"pl-8\", \"pr-3\", \"py-1.5\", \"border\", \"border-blue-200\", \"rounded\", \"text-sm\", \"focus:ring-1\", \"focus:ring-blue-500\", \"outline-none\", \"bg-white\", 3, \"input\"], [1, \"absolute\", \"left-2.5\", \"top-1/2\", \"-translate-y-1/2\", \"text-blue-400\"], [1, \"flex-1\", \"overflow-y-auto\", \"p-2\"], [1, \"space-y-1\"], [\"class\", \"flex items-center p-3 rounded-lg border transition-all cursor-pointer select-none group\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-center p-4 text-xs text-gray-500 italic\", 4, \"ngIf\"], [1, \"p-4\", \"border-t\", \"border-gray-200\", \"bg-gray-50\", \"rounded-b-lg\", \"space-y-3\"], [1, \"flex\", \"items-center\", \"justify-between\", \"text-xs\", \"text-gray-600\", \"mb-1\"], [1, \"flex\", \"items-center\", \"gap-3\", \"text-sm\"], [1, \"flex\", \"items-center\", \"gap-2\", \"text-gray-700\"], [\"type\", \"checkbox\", 1, \"w-4\", \"h-4\", 3, \"change\", \"checked\"], [1, \"w-full\", \"flex\", \"items-center\", \"justify-center\", \"gap-2\", \"bg-blue-600\", \"hover:bg-blue-700\", \"disabled:bg-gray-300\", \"disabled:cursor-not-allowed\", \"text-white\", \"font-medium\", \"py-2.5\", \"px-4\", \"rounded\", \"shadow-sm\", \"transition-all\", \"text-sm\", 3, \"click\", \"disabled\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"16\", \"height\", \"16\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [\"d\", \"M5 12h14\"], [\"d\", \"M12 5v14\"], [1, \"w-full\", \"flex\", \"items-center\", \"justify-center\", \"gap-2\", \"bg-white\", \"border\", \"border-red-200\", \"text-red-600\", \"hover:bg-red-50\", \"disabled:bg-gray-50\", \"disabled:text-gray-300\", \"disabled:border-gray-200\", \"font-medium\", \"py-2.5\", \"px-4\", \"rounded\", \"transition-all\", \"text-sm\", 3, \"click\", \"disabled\"], [\"d\", \"M3 6h18\"], [\"d\", \"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\"], [\"d\", \"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\"], [\"class\", \"absolute inset-0 z-50 flex items-center justify-center\", 4, \"ngIf\"], [1, \"absolute\", \"top-4\", \"left-1/2\", \"-translate-x-1/2\", \"z-50\", \"flex\", \"items-center\", \"gap-3\", \"px-4\", \"py-3\", \"rounded-lg\", \"shadow-lg\", \"border\", \"animate-in\", \"fade-in\", \"slide-in-from-top-4\", \"duration-300\", 3, \"ngClass\"], [3, \"ngClass\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"20\", \"height\", \"20\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", 4, \"ngIf\"], [1, \"text-sm\", \"font-medium\"], [1, \"ml-2\", \"hover:opacity-70\", 3, \"click\"], [\"x1\", \"18\", \"y1\", \"6\", \"x2\", \"6\", \"y2\", \"18\"], [\"x1\", \"6\", \"y1\", \"6\", \"x2\", \"18\", \"y2\", \"18\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"20\", \"height\", \"20\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [\"d\", \"M22 11.08V12a10 10 0 1 1-5.93-9.14\"], [\"points\", \"22 4 12 14.01 9 11.01\"], [\"d\", \"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z\"], [\"x1\", \"12\", \"y1\", \"9\", \"x2\", \"12\", \"y2\", \"13\"], [\"x1\", \"12\", \"y1\", \"17\", \"x2\", \"12.01\", \"y2\", \"17\"], [\"cx\", \"12\", \"cy\", \"12\", \"r\", \"10\"], [\"x1\", \"15\", \"y1\", \"9\", \"x2\", \"9\", \"y2\", \"15\"], [\"x1\", \"9\", \"y1\", \"9\", \"x2\", \"15\", \"y2\", \"15\"], [1, \"hover:bg-blue-50/40\", \"transition-colors\", 3, \"ngClass\"], [1, \"px-4\", \"py-3\", \"cursor-pointer\", 3, \"click\"], [1, \"font-medium\", \"text-gray-800\", \"text-sm\"], [1, \"text-xs\", \"text-gray-500\", \"font-mono\"], [1, \"px-4\", \"py-3\", \"cursor-pointer\", \"text-sm\", \"text-gray-600\", 3, \"click\"], [1, \"px-4\", \"py-3\"], [1, \"grid\", \"grid-cols-3\", \"gap-1.5\", \"w-fit\", 3, \"click\", \"ngClass\"], [4, \"ngIf\", \"ngIfElse\"], [\"class\", \"inline-flex items-center justify-center px-2 py-0.5 rounded text-xs font-medium truncate whitespace-nowrap\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [1, \"inline-flex\", \"items-center\", \"justify-center\", \"px-2\", \"py-0.5\", \"rounded\", \"text-xs\", \"font-medium\", \"truncate\", \"whitespace-nowrap\", 3, \"ngClass\"], [\"class\", \"ml-1 text-[10px] font-bold bg-red-600 text-white px-1 rounded\", 4, \"ngIf\"], [1, \"ml-1\", \"text-[10px]\", \"font-bold\", \"bg-red-600\", \"text-white\", \"px-1\", \"rounded\"], [1, \"text-gray-400\", \"select-none\"], [\"colspan\", \"4\", 1, \"p-8\", \"text-center\", \"text-gray-500\", \"text-sm\"], [1, \"flex\", \"items-center\", \"p-3\", \"rounded-lg\", \"border\", \"transition-all\", \"cursor-pointer\", \"select-none\", \"group\", 3, \"ngClass\"], [\"type\", \"checkbox\", 1, \"hidden\", 3, \"change\", \"checked\"], [1, \"flex\", \"items-center\", \"justify-center\", \"w-5\", \"h-5\", \"rounded\", \"border\", \"mr-3\", \"transition-colors\", \"shrink-0\", 3, \"ngClass\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"12\", \"height\", \"12\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"3\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", 4, \"ngIf\"], [1, \"flex-1\", \"min-w-0\"], [1, \"text-sm\", \"font-medium\", \"truncate\", 3, \"ngClass\"], [1, \"text-xs\", \"text-gray-500\", \"truncate\"], [1, \"text-[10px]\", \"text-gray-400\", \"font-mono\", \"mt-0.5\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"12\", \"height\", \"12\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"3\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [\"points\", \"20 6 9 17 4 12\"], [1, \"text-center\", \"p-4\", \"text-xs\", \"text-gray-500\", \"italic\"], [1, \"absolute\", \"inset-0\", \"z-50\", \"flex\", \"items-center\", \"justify-center\"], [1, \"absolute\", \"inset-0\", \"bg-black/40\", \"backdrop-blur-sm\", 3, \"click\"], [1, \"relative\", \"bg-white\", \"rounded-xl\", \"shadow-2xl\", \"w-[90%]\", \"max-w-4xl\", \"max-h-[90%]\", \"flex\", \"flex-col\", \"overflow-hidden\", \"animate-in\", \"fade-in\", \"zoom-in\", \"duration-200\"], [1, \"p-4\", \"border-b\", \"border-gray-100\", \"flex\", \"items-center\", \"justify-between\", \"bg-gray-50\"], [1, \"font-bold\", \"text-gray-800\", \"text-lg\"], [1, \"text-sm\", \"text-gray-500\"], [1, \"font-semibold\", \"text-blue-600\"], [1, \"p-2\", \"hover:bg-gray-200\", \"rounded-full\", \"transition-colors\", 3, \"click\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"20\", \"height\", \"20\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", 1, \"text-gray-500\"], [1, \"p-6\", \"overflow-y-auto\", \"bg-gray-50/50\"], [1, \"grid\", \"grid-cols-1\", \"md:grid-cols-2\", \"lg:grid-cols-3\", \"gap-6\"], [\"class\", \"bg-white rounded-xl border border-gray-200 shadow-sm p-5 hover:shadow-md transition-shadow relative group\", 4, \"ngFor\", \"ngForOf\"], [1, \"bg-white\", \"rounded-xl\", \"border\", \"border-gray-200\", \"shadow-sm\", \"p-5\", \"hover:shadow-md\", \"transition-shadow\", \"relative\", \"group\"], [1, \"flex\", \"items-start\", \"gap-4\", \"mb-4\"], [\"alt\", \"Avatar\", 1, \"w-12\", \"h-12\", \"rounded-full\", \"border\", \"border-gray-100\", \"bg-gray-50\", \"object-cover\", 3, \"src\"], [1, \"font-bold\", \"text-gray-800\", \"text-base\", \"uppercase\", \"leading-tight\"], [1, \"inline-block\", \"mt-1\", \"px-2\", \"py-0.5\", \"bg-green-50\", \"text-green-700\", \"text-[10px]\", \"font-bold\", \"uppercase\", \"rounded\", \"border\", \"border-green-100\"], [1, \"space-y-3\", \"mb-5\"], [1, \"flex\", \"items-center\", \"gap-3\", \"text-sm\", \"text-gray-600\"], [1, \"w-5\", \"text-center\", \"text-gray-400\"], [\"width\", \"18\", \"height\", \"18\", \"x\", \"3\", \"y\", \"4\", \"rx\", \"2\", \"ry\", \"2\"], [\"x1\", \"16\", \"x2\", \"16\", \"y1\", \"2\", \"y2\", \"6\"], [\"x1\", \"8\", \"x2\", \"8\", \"y1\", \"2\", \"y2\", \"6\"], [\"x1\", \"3\", \"x2\", \"21\", \"y1\", \"10\", \"y2\", \"10\"], [1, \"bg-blue-50\", \"text-blue-700\", \"px-2\", \"rounded-full\", \"text-xs\", \"font-medium\"], [\"width\", \"20\", \"height\", \"14\", \"x\", \"2\", \"y\", \"5\", \"rx\", \"2\"], [\"d\", \"M2 10h20\"], [\"d\", \"M7 15h.01\"], [\"d\", \"M17 15h.01\"], [1, \"font-medium\", \"text-gray-800\"], [\"d\", \"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"], [1, \"flex\", \"items-start\", \"gap-3\", \"text-sm\", \"text-gray-600\"], [1, \"w-5\", \"text-center\", \"text-gray-400\", \"mt-0.5\"], [\"d\", \"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z\"], [\"cx\", \"12\", \"cy\", \"10\", \"r\", \"3\"], [1, \"text-xs\", \"leading-relaxed\", \"line-clamp-2\", 3, \"title\"], [1, \"flex\", \"gap-2\", \"mt-auto\"], [1, \"flex-1\", \"flex\", \"items-center\", \"justify-center\", \"gap-2\", \"border\", \"border-gray-300\", \"rounded\", \"py-2\", \"text-sm\", \"font-medium\", \"text-gray-700\", \"hover:bg-gray-50\", \"transition-colors\"]],\n        template: function TeacherAssignmentComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 1);\n            i0.ɵɵtemplate(1, TeacherAssignmentComponent_div_1_Template, 11, 14, \"div\", 2);\n            i0.ɵɵelementStart(2, \"div\", 3)(3, \"div\", 4)(4, \"div\", 5)(5, \"h3\", 6);\n            i0.ɵɵtext(6, \"Danh s\\u00E1ch h\\u1ECDc sinh\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"div\", 7)(8, \"div\", 8);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(9, \"svg\", 9);\n            i0.ɵɵelement(10, \"path\", 10)(11, \"circle\", 11)(12, \"path\", 12)(13, \"path\", 13);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(14, \" T\\u1ED5ng s\\u1ED1 HS: \");\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(15, \"b\");\n            i0.ɵɵtext(16);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(17, \" em \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(18, \"div\", 14);\n            i0.ɵɵelementStart(19, \"button\", 15);\n            i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_Template_button_click_19_listener() {\n              return ctx.toggleUnassignedFilter();\n            });\n            i0.ɵɵelement(20, \"div\", 16);\n            i0.ɵɵtext(21, \" H\\u1ECDc sinh ch\\u01B0a c\\u00F3 GV: \");\n            i0.ɵɵelementStart(22, \"b\");\n            i0.ɵɵtext(23);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(24, \" em \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(25, \"div\", 14);\n            i0.ɵɵelementStart(26, \"p\", 17);\n            i0.ɵɵtext(27, \"\\u0110\\u00E3 ch\\u1ECDn: \");\n            i0.ɵɵelementStart(28, \"span\", 18);\n            i0.ɵɵtext(29);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(30, \" em\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(31, \"div\", 19)(32, \"div\", 20)(33, \"select\", 21);\n            i0.ɵɵlistener(\"change\", function TeacherAssignmentComponent_Template_select_change_33_listener($event) {\n              return ctx.onClassFilterChange($event);\n            });\n            i0.ɵɵelementStart(34, \"option\", 22);\n            i0.ɵɵtext(35, \"T\\u1EA5t c\\u1EA3 l\\u1EDBp\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(36, \"optgroup\", 23)(37, \"option\", 24);\n            i0.ɵɵtext(38, \"Kh\\u1ED1i M\\u1EA7m\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(39, \"option\", 25);\n            i0.ɵɵtext(40, \"Kh\\u1ED1i Ch\\u1ED3i\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(41, \"option\", 26);\n            i0.ɵɵtext(42, \"Kh\\u1ED1i L\\u00E1\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(43, \"optgroup\", 27)(44, \"option\", 28);\n            i0.ɵɵtext(45, \"6-18 th\\u00E1ng\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(46, \"option\", 29);\n            i0.ɵɵtext(47, \"19-24 th\\u00E1ng\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(48, \"option\", 30);\n            i0.ɵɵtext(49, \"25-36 th\\u00E1ng\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(50, \"div\", 31);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(51, \"svg\", 32);\n            i0.ɵɵelement(52, \"path\", 33);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(53, \"div\", 34)(54, \"input\", 35);\n            i0.ɵɵlistener(\"input\", function TeacherAssignmentComponent_Template_input_input_54_listener($event) {\n              return ctx.onStudentSearch($event);\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(55, \"div\", 36);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(56, \"svg\", 9);\n            i0.ɵɵelement(57, \"circle\", 37)(58, \"path\", 38);\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(59, \"div\", 39)(60, \"table\", 40)(61, \"thead\", 41)(62, \"tr\")(63, \"th\", 42)(64, \"input\", 43);\n            i0.ɵɵlistener(\"change\", function TeacherAssignmentComponent_Template_input_change_64_listener() {\n              return ctx.toggleSelectAll();\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(65, \"th\", 44);\n            i0.ɵɵtext(66, \"H\\u1ECDc sinh\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(67, \"th\", 44);\n            i0.ɵɵtext(68, \"L\\u1EDBp\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(69, \"th\", 44);\n            i0.ɵɵtext(70, \"Gi\\u00E1o vi\\u00EAn \\u0111ang d\\u1EA1y\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(71, \"tbody\", 45);\n            i0.ɵɵtemplate(72, TeacherAssignmentComponent_tr_72_Template, 15, 12, \"tr\", 46)(73, TeacherAssignmentComponent_tr_73_Template, 3, 1, \"tr\", 47);\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(74, \"div\", 48)(75, \"div\", 49)(76, \"h3\", 50);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(77, \"svg\", 51);\n            i0.ɵɵelement(78, \"path\", 10)(79, \"circle\", 11)(80, \"path\", 12)(81, \"path\", 13);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(82, \" Ch\\u1ECDn Gi\\u00E1o Vi\\u00EAn \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(83, \"div\", 52)(84, \"input\", 53);\n            i0.ɵɵlistener(\"input\", function TeacherAssignmentComponent_Template_input_input_84_listener($event) {\n              return ctx.onTeacherSearch($event);\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(85, \"div\", 54);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(86, \"svg\", 9);\n            i0.ɵɵelement(87, \"circle\", 37)(88, \"path\", 38);\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(89, \"div\", 55)(90, \"div\", 56);\n            i0.ɵɵtemplate(91, TeacherAssignmentComponent_label_91_Template, 11, 17, \"label\", 57)(92, TeacherAssignmentComponent_div_92_Template, 2, 0, \"div\", 58);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(93, \"div\", 59)(94, \"div\", 60)(95, \"span\");\n            i0.ɵɵtext(96, \"Ch\\u1ECDn: \");\n            i0.ɵɵelementStart(97, \"b\");\n            i0.ɵɵtext(98);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(99, \" GV\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(100, \"span\");\n            i0.ɵɵtext(101, \"\\u00C1p d\\u1EE5ng: \");\n            i0.ɵɵelementStart(102, \"b\");\n            i0.ɵɵtext(103);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(104, \" HS\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(105, \"div\", 61)(106, \"label\", 62)(107, \"input\", 63);\n            i0.ɵɵlistener(\"change\", function TeacherAssignmentComponent_Template_input_change_107_listener($event) {\n              return ctx.onHomeroomToggle($event.target.checked);\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(108, \"span\");\n            i0.ɵɵtext(109, \"\\u0110\\u1EB7t l\\u00E0m Gi\\u00E1o vi\\u00EAn ch\\u1EE7 nhi\\u1EC7m\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(110, \"div\", 17);\n            i0.ɵɵtext(111, \"N\\u1EBFu b\\u1EADt, gi\\u00E1o vi\\u00EAn \\u0111\\u1EA7u ti\\u00EAn s\\u1EBD \\u0111\\u01B0\\u1EE3c \\u0111\\u1EB7t l\\u00E0m GVCN cho HS \\u0111\\u00E3 ch\\u1ECDn.\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(112, \"button\", 64);\n            i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_Template_button_click_112_listener() {\n              return ctx.applyAssignment();\n            });\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(113, \"svg\", 65);\n            i0.ɵɵelement(114, \"path\", 66)(115, \"path\", 67);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(116, \" Th\\u00EAm ph\\u00E2n c\\u00F4ng \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(117, \"button\", 68);\n            i0.ɵɵlistener(\"click\", function TeacherAssignmentComponent_Template_button_click_117_listener() {\n              return ctx.removeAssignment();\n            });\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(118, \"svg\", 65);\n            i0.ɵɵelement(119, \"path\", 69)(120, \"path\", 70)(121, \"path\", 71);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(122, \" G\\u1EE1 ph\\u00E2n c\\u00F4ng \");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(123, TeacherAssignmentComponent_div_123_Template, 18, 2, \"div\", 72);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showToast);\n            i0.ɵɵadvance(15);\n            i0.ɵɵtextInterpolate(ctx.students.length);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(18, _c0, ctx.showUnassignedOnly, !ctx.showUnassignedOnly));\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngClass\", ctx.unassignedCount > 0 ? \"bg-orange-500\" : \"bg-gray-300\");\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate(ctx.unassignedCount);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtextInterpolate(ctx.selectedStudentIds.size);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"disabled\", ctx.showUnassignedOnly);\n            i0.ɵɵadvance(31);\n            i0.ɵɵproperty(\"checked\", ctx.isAllSelected());\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"ngForOf\", ctx.filteredStudents);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.filteredStudents.length === 0);\n            i0.ɵɵadvance(18);\n            i0.ɵɵproperty(\"ngForOf\", ctx.filteredTeachers);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.filteredTeachers.length === 0);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtextInterpolate(ctx.selectedTeacherIds.size);\n            i0.ɵɵadvance(5);\n            i0.ɵɵtextInterpolate(ctx.selectedStudentIds.size);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"checked\", ctx.assignAsHomeroom);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"disabled\", ctx.selectedStudentIds.size === 0 || ctx.selectedTeacherIds.size === 0);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"disabled\", ctx.selectedStudentIds.size === 0 || ctx.selectedTeacherIds.size === 0);\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"ngIf\", ctx.viewingStudentDetails);\n          }\n        },\n        dependencies: [CommonModule, i1.NgClass, i1.NgForOf, i1.NgIf],\n        encapsulation: 2\n      });\n    }\n  }\n  return TeacherAssignmentComponent;\n})();","map":{"version":3,"names":["ElementRef","CommonModule","MOCK_STUDENTS","MOCK_TEACHERS","i0","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","ɵɵtemplate","TeacherAssignmentComponent_div_1__svg_svg_2_Template","TeacherAssignmentComponent_div_1__svg_svg_3_Template","TeacherAssignmentComponent_div_1__svg_svg_4_Template","ɵɵtext","ɵɵlistener","TeacherAssignmentComponent_div_1_Template_button_click_7_listener","ɵɵrestoreView","_r1","ctx_r1","ɵɵnextContext","ɵɵresetView","showToast","ɵɵproperty","ɵɵpureFunction3","_c1","toastType","ɵɵadvance","_c2","ɵɵtextInterpolate","toastMessage","TeacherAssignmentComponent_tr_72_ng_container_12_span_1_span_3_Template","student_r4","homeroomTeacherId","t_r5","id","shortName","ɵɵelementContainerStart","TeacherAssignmentComponent_tr_72_ng_container_12_span_1_Template","getAssignedTeachers","TeacherAssignmentComponent_tr_72_Template_td_click_1_listener","_r3","$implicit","toggleStudent","TeacherAssignmentComponent_tr_72_Template_input_change_2_listener","TeacherAssignmentComponent_tr_72_Template_td_click_3_listener","TeacherAssignmentComponent_tr_72_Template_td_click_8_listener","TeacherAssignmentComponent_tr_72_Template_div_click_11_listener","openTeacherDetails","TeacherAssignmentComponent_tr_72_ng_container_12_Template","TeacherAssignmentComponent_tr_72_ng_template_13_Template","ɵɵtemplateRefExtractor","ɵɵpureFunction1","_c3","selectedStudentIds","has","fullName","code","ɵɵtextInterpolate1","className","_c4","length","noTeacher_r6","showUnassignedOnly","TeacherAssignmentComponent_label_91_Template_input_change_1_listener","teacher_r8","_r7","toggleTeacherSelection","TeacherAssignmentComponent_label_91__svg_svg_3_Template","ɵɵpureFunction2","_c5","isTeacherSelected","_c6","_c7","name","cccd","slice","teacher_r10","avatar","ɵɵsanitizeUrl","dob","gender","phone","ɵɵpropertyInterpolate","address","TeacherAssignmentComponent_div_123_Template_div_click_1_listener","_r9","closeTeacherDetails","TeacherAssignmentComponent_div_123_Template_button_click_11_listener","TeacherAssignmentComponent_div_123_div_17_Template","viewingStudentDetails","viewingTeachers","TeacherAssignmentComponent","constructor","elementRef","students","teachers","filteredStudents","filteredTeachers","Set","selectedTeacherIds","studentSearchTerm","classFilter","teacherSearchTerm","assignAsHomeroom","applyStudentFilters","showNotification","message","type","setTimeout","unassignedCount","filter","s","assignedTeacherIds","toggleUnassignedFilter","onStudentSearch","event","target","value","toLowerCase","onClassFilterChange","getClassPriority","includes","result","matchesSearch","matchesClass","isUnassigned","matchesUnassigned","sort","a","b","priorityA","priorityB","localeCompare","onTeacherSearch","t","delete","add","toggleSelectAll","isAllSelected","clear","forEach","size","teacherId","applyAssignment","teachersToAdd","Array","from","countSuccess","student","added","newId","teacher","find","push","removeAssignment","teachersToRemove","changeCount","originalLength","existingId","undefined","assigned","ɵɵdirectiveInject","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","TeacherAssignmentComponent_Template","rf","ctx","TeacherAssignmentComponent_div_1_Template","TeacherAssignmentComponent_Template_button_click_19_listener","TeacherAssignmentComponent_Template_select_change_33_listener","$event","TeacherAssignmentComponent_Template_input_input_54_listener","TeacherAssignmentComponent_Template_input_change_64_listener","TeacherAssignmentComponent_tr_72_Template","TeacherAssignmentComponent_tr_73_Template","TeacherAssignmentComponent_Template_input_input_84_listener","TeacherAssignmentComponent_label_91_Template","TeacherAssignmentComponent_div_92_Template","TeacherAssignmentComponent_Template_input_change_107_listener","onHomeroomToggle","checked","TeacherAssignmentComponent_Template_button_click_112_listener","TeacherAssignmentComponent_Template_button_click_117_listener","TeacherAssignmentComponent_div_123_Template","_c0","i1","NgClass","NgForOf","NgIf","encapsulation"],"sources":["D:\\VN AI SOFTWARE\\Code\\phan-cong-giao-vien\\components\\TeacherAssignment.ts"],"sourcesContent":["\r\nimport { Component, ElementRef, Inject } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MOCK_STUDENTS, MOCK_TEACHERS } from '../constants';\r\nimport { Student, Teacher } from '../types';\r\n\r\n@Component({\r\n  selector: 'app-teacher-assignment',\r\n  standalone: true,\r\n  imports: [CommonModule],\r\n  template: `\r\n    <div class=\"flex flex-col lg:flex-row gap-6 h-[calc(100vh-140px)] relative\">\r\n      \r\n      <!-- TOAST NOTIFICATION -->\r\n      <div *ngIf=\"showToast\" \r\n           class=\"absolute top-4 left-1/2 -translate-x-1/2 z-50 flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg border animate-in fade-in slide-in-from-top-4 duration-300\"\r\n           [ngClass]=\"{\r\n             'bg-green-50 border-green-200 text-green-800': toastType === 'success',\r\n             'bg-yellow-50 border-yellow-200 text-yellow-800': toastType === 'warning',\r\n             'bg-red-50 border-red-200 text-red-800': toastType === 'error'\r\n           }\">\r\n         <div [ngClass]=\"{\r\n             'text-green-500': toastType === 'success',\r\n             'text-yellow-500': toastType === 'warning',\r\n             'text-red-500': toastType === 'error'\r\n         }\">\r\n            <svg *ngIf=\"toastType === 'success'\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\"/><polyline points=\"22 4 12 14.01 9 11.01\"/></svg>\r\n            <svg *ngIf=\"toastType === 'warning'\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z\"/><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/></svg>\r\n            <svg *ngIf=\"toastType === 'error'\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"/><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"/><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"/></svg>\r\n         </div>\r\n         <div class=\"text-sm font-medium\">{{ toastMessage }}</div>\r\n         <button (click)=\"showToast = false\" class=\"ml-2 hover:opacity-70\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>\r\n         </button>\r\n      </div>\r\n\r\n      <!-- LEFT COLUMN: STUDENT LIST (Main Work Area) -->\r\n      <div class=\"flex-1 bg-white rounded-lg shadow-sm border border-gray-200 flex flex-col overflow-hidden\">\r\n        \r\n        <!-- Header & Search -->\r\n        <div class=\"p-4 border-b border-gray-200 bg-gray-50 flex flex-col gap-3\">\r\n          <div class=\"flex items-center justify-between\">\r\n             <h3 class=\"font-semibold text-gray-800\">Danh sách học sinh</h3>\r\n             \r\n             <div class=\"flex items-center gap-3\">\r\n                <!-- Total Students Badge -->\r\n                <div class=\"flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-blue-50 text-blue-700 border border-blue-100\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\"/><circle cx=\"9\" cy=\"7\" r=\"4\"/><path d=\"M22 21v-2a4 4 0 0 0-3-3.87\"/><path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/></svg>\r\n                    Tổng số HS: <b>{{ students.length }}</b> em\r\n                </div>\r\n\r\n                <div class=\"h-4 w-px bg-gray-300\"></div>\r\n\r\n                <!-- Unassigned Filter Toggle -->\r\n                <button \r\n                  (click)=\"toggleUnassignedFilter()\"\r\n                  class=\"flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium border transition-colors shadow-sm\"\r\n                  [ngClass]=\"{\r\n                    'bg-orange-50 text-orange-700 border-orange-200 hover:bg-orange-100': showUnassignedOnly,\r\n                    'bg-white text-gray-600 border-gray-300 hover:bg-gray-50': !showUnassignedOnly\r\n                  }\">\r\n                   <div class=\"w-2 h-2 rounded-full\" [ngClass]=\"unassignedCount > 0 ? 'bg-orange-500' : 'bg-gray-300'\"></div>\r\n                   Học sinh chưa có GV: <b>{{ unassignedCount }}</b> em\r\n                </button>\r\n\r\n                <div class=\"h-4 w-px bg-gray-300\"></div>\r\n\r\n                <p class=\"text-xs text-gray-500\">Đã chọn: <span class=\"font-bold text-blue-600\">{{ selectedStudentIds.size }}</span> em</p>\r\n             </div>\r\n          </div>\r\n          \r\n          <div class=\"flex gap-3\">\r\n             <!-- Class Filter -->\r\n             <div class=\"relative w-40\">\r\n                <select \r\n                  (change)=\"onClassFilterChange($event)\"\r\n                  [disabled]=\"showUnassignedOnly\"\r\n                  class=\"w-full pl-2 pr-8 py-1.5 border border-gray-300 rounded text-sm focus:ring-1 focus:ring-blue-500 outline-none appearance-none bg-white disabled:bg-gray-100 disabled:text-gray-400\">\r\n                  <option value=\"\">Tất cả lớp</option>\r\n                  <optgroup label=\"Mẫu Giáo\">\r\n                    <option value=\"Mầm\">Khối Mầm</option>\r\n                    <option value=\"Chồi\">Khối Chồi</option>\r\n                    <option value=\"Lá\">Khối Lá</option>\r\n                  </optgroup>\r\n                  <optgroup label=\"Nhà Trẻ\">\r\n                    <option value=\"6-18\">6-18 tháng</option>\r\n                    <option value=\"19-24\">19-24 tháng</option>\r\n                    <option value=\"25-36\">25-36 tháng</option>\r\n                  </optgroup>\r\n                </select>\r\n                <div class=\"absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m6 9 6 6 6-6\"/></svg>\r\n                </div>\r\n             </div>\r\n\r\n             <!-- Student Search -->\r\n             <div class=\"relative flex-1\">\r\n                <input \r\n                  type=\"text\" \r\n                  (input)=\"onStudentSearch($event)\"\r\n                  placeholder=\"Tìm tên hoặc mã số...\" \r\n                  class=\"pl-9 pr-4 py-1.5 w-full border border-gray-300 rounded text-sm focus:ring-1 focus:ring-blue-500 outline-none\"\r\n                >\r\n                <div class=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\">\r\n                   <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"11\" cy=\"11\" r=\"8\"/><path d=\"m21 21-4.3-4.3\"/></svg>\r\n                </div>\r\n             </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Table -->\r\n        <div class=\"flex-1 overflow-auto\">\r\n          <table class=\"w-full text-left border-collapse\">\r\n            <thead class=\"bg-white sticky top-0 z-10 shadow-sm text-xs font-semibold text-gray-500 uppercase\">\r\n              <tr>\r\n                <th class=\"px-4 py-3 border-b w-10 bg-gray-50\">\r\n                   <input type=\"checkbox\" [checked]=\"isAllSelected()\" (change)=\"toggleSelectAll()\" class=\"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer\">\r\n                </th>\r\n                <th class=\"px-4 py-3 border-b bg-gray-50\">Học sinh</th>\r\n                <th class=\"px-4 py-3 border-b bg-gray-50\">Lớp</th>\r\n                <th class=\"px-4 py-3 border-b bg-gray-50\">Giáo viên đang dạy</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody class=\"divide-y divide-gray-100\">\r\n              <tr *ngFor=\"let student of filteredStudents\" \r\n                  class=\"hover:bg-blue-50/40 transition-colors\"\r\n                  [ngClass]=\"{'bg-blue-50': selectedStudentIds.has(student.id)}\">\r\n                \r\n                <!-- Checkbox Column -->\r\n                <td class=\"px-4 py-3 cursor-pointer\" (click)=\"toggleStudent(student.id)\">\r\n                   <input type=\"checkbox\" [checked]=\"selectedStudentIds.has(student.id)\" (change)=\"toggleStudent(student.id)\" class=\"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer\">\r\n                </td>\r\n\r\n                <!-- Info Column -->\r\n                <td class=\"px-4 py-3 cursor-pointer\" (click)=\"toggleStudent(student.id)\">\r\n                  <div class=\"font-medium text-gray-800 text-sm\">{{ student.fullName }}</div>\r\n                  <div class=\"text-xs text-gray-500 font-mono\">{{ student.code }}</div>\r\n                </td>\r\n\r\n                <!-- Class Column -->\r\n                <td class=\"px-4 py-3 cursor-pointer text-sm text-gray-600\" (click)=\"toggleStudent(student.id)\">\r\n                   {{ student.className }}\r\n                </td>\r\n\r\n                <!-- Assigned Teachers Column (Click to View Details) -->\r\n                <td class=\"px-4 py-3\">\r\n                  <div class=\"grid grid-cols-3 gap-1.5 w-fit\" \r\n                       (click)=\"openTeacherDetails(student)\"\r\n                       [ngClass]=\"{'cursor-pointer hover:opacity-80': getAssignedTeachers(student).length > 0}\">\r\n                    <ng-container *ngIf=\"getAssignedTeachers(student).length > 0; else noTeacher\">\r\n                       <span *ngFor=\"let t of getAssignedTeachers(student)\" \r\n                          class=\"inline-flex items-center justify-center px-2 py-0.5 rounded text-xs font-medium truncate whitespace-nowrap\"\r\n                          [ngClass]=\"student.homeroomTeacherId === t.id ? 'bg-red-100 text-red-800 border border-red-200' : 'bg-blue-100 text-blue-800 border border-blue-200'\">\r\n                        <span>{{ t.shortName }}</span>\r\n                        <span *ngIf=\"student.homeroomTeacherId === t.id\" class=\"ml-1 text-[10px] font-bold bg-red-600 text-white px-1 rounded\">CN</span>\r\n                      </span>\r\n                    </ng-container>\r\n                    <ng-template #noTeacher>\r\n                      <span class=\"text-gray-400 select-none\">-</span>\r\n                    </ng-template>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n              <tr *ngIf=\"filteredStudents.length === 0\">\r\n                 <td colspan=\"4\" class=\"p-8 text-center text-gray-500 text-sm\">\r\n                    {{ showUnassignedOnly ? 'Tuyệt vời! Tất cả học sinh đều đã có giáo viên.' : 'Không tìm thấy học sinh phù hợp' }}\r\n                 </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- RIGHT COLUMN: TEACHER PALETTE (Fixed Action Area) -->\r\n      <div class=\"w-full lg:w-80 bg-white rounded-lg shadow-sm border border-gray-200 flex flex-col\">\r\n        <div class=\"p-4 border-b border-gray-200 bg-blue-50 rounded-t-lg\">\r\n           <h3 class=\"font-semibold text-blue-900 flex items-center gap-2\">\r\n             <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\"/><circle cx=\"9\" cy=\"7\" r=\"4\"/><path d=\"M22 21v-2a4 4 0 0 0-3-3.87\"/><path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/></svg>\r\n             Chọn Giáo Viên\r\n           </h3>\r\n           \r\n           <!-- Teacher Search -->\r\n           <div class=\"mt-3 relative\">\r\n             <input \r\n               type=\"text\" \r\n               (input)=\"onTeacherSearch($event)\"\r\n               placeholder=\"Tìm tên hoặc CCCD...\" \r\n               class=\"w-full pl-8 pr-3 py-1.5 border border-blue-200 rounded text-sm focus:ring-1 focus:ring-blue-500 outline-none bg-white\"\r\n             >\r\n             <div class=\"absolute left-2.5 top-1/2 -translate-y-1/2 text-blue-400\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"11\" cy=\"11\" r=\"8\"/><path d=\"m21 21-4.3-4.3\"/></svg>\r\n             </div>\r\n           </div>\r\n        </div>\r\n\r\n        <div class=\"flex-1 overflow-y-auto p-2\">\r\n           <div class=\"space-y-1\">\r\n             <label *ngFor=\"let teacher of filteredTeachers\" \r\n                    class=\"flex items-center p-3 rounded-lg border transition-all cursor-pointer select-none group\"\r\n                    [ngClass]=\"{\r\n                      'bg-blue-50 border-blue-300 shadow-sm': isTeacherSelected(teacher.id),\r\n                      'bg-white border-transparent hover:bg-gray-50': !isTeacherSelected(teacher.id)\r\n                    }\">\r\n                <input type=\"checkbox\" \r\n                       class=\"hidden\"\r\n                       [checked]=\"isTeacherSelected(teacher.id)\"\r\n                       (change)=\"toggleTeacherSelection(teacher.id)\">\r\n                \r\n                <div class=\"flex items-center justify-center w-5 h-5 rounded border mr-3 transition-colors shrink-0\"\r\n                     [ngClass]=\"{\r\n                       'bg-blue-600 border-blue-600 text-white': isTeacherSelected(teacher.id),\r\n                       'border-gray-300 bg-white': !isTeacherSelected(teacher.id)\r\n                     }\">\r\n                     <svg *ngIf=\"isTeacherSelected(teacher.id)\" xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"/></svg>\r\n                </div>\r\n\r\n                <div class=\"flex-1 min-w-0\">\r\n                   <div class=\"text-sm font-medium truncate\" [ngClass]=\"{'text-blue-900': isTeacherSelected(teacher.id), 'text-gray-700': !isTeacherSelected(teacher.id)}\">{{ teacher.shortName }}</div>\r\n                   <div class=\"text-xs text-gray-500 truncate\">{{ teacher.name }}</div>\r\n                   <div class=\"text-[10px] text-gray-400 font-mono mt-0.5\">ID: {{ teacher.cccd.slice(-4) }}</div>\r\n                </div>\r\n             </label>\r\n             <div *ngIf=\"filteredTeachers.length === 0\" class=\"text-center p-4 text-xs text-gray-500 italic\">\r\n               Không tìm thấy giáo viên\r\n             </div>\r\n           </div>\r\n        </div>\r\n\r\n        <!-- ACTIONS -->\r\n        <div class=\"p-4 border-t border-gray-200 bg-gray-50 rounded-b-lg space-y-3\">\r\n           <div class=\"flex items-center justify-between text-xs text-gray-600 mb-1\">\r\n             <span>Chọn: <b>{{ selectedTeacherIds.size }}</b> GV</span>\r\n             <span>Áp dụng: <b>{{ selectedStudentIds.size }}</b> HS</span>\r\n           </div>\r\n\r\n           <div class=\"flex items-center gap-3 text-sm\">\r\n             <label class=\"flex items-center gap-2 text-gray-700\">\r\n               <input type=\"checkbox\" class=\"w-4 h-4\" [checked]=\"assignAsHomeroom\" (change)=\"onHomeroomToggle($any($event.target).checked)\">\r\n               <span>Đặt làm Giáo viên chủ nhiệm</span>\r\n             </label>\r\n             <div class=\"text-xs text-gray-500\">Nếu bật, giáo viên đầu tiên sẽ được đặt làm GVCN cho HS đã chọn.</div>\r\n           </div>\r\n\r\n           <button (click)=\"applyAssignment()\" \r\n                   [disabled]=\"selectedStudentIds.size === 0 || selectedTeacherIds.size === 0\"\r\n                   class=\"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-medium py-2.5 px-4 rounded shadow-sm transition-all text-sm\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M5 12h14\"/><path d=\"M12 5v14\"/></svg>\r\n              Thêm phân công\r\n           </button>\r\n\r\n           <button (click)=\"removeAssignment()\" \r\n                   [disabled]=\"selectedStudentIds.size === 0 || selectedTeacherIds.size === 0\"\r\n                   class=\"w-full flex items-center justify-center gap-2 bg-white border border-red-200 text-red-600 hover:bg-red-50 disabled:bg-gray-50 disabled:text-gray-300 disabled:border-gray-200 font-medium py-2.5 px-4 rounded transition-all text-sm\">\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M3 6h18\"/><path d=\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\"/><path d=\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\"/></svg>\r\n              Gỡ phân công\r\n           </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- TEACHER DETAILS MODAL (Overlay) -->\r\n      <div *ngIf=\"viewingStudentDetails\" class=\"absolute inset-0 z-50 flex items-center justify-center\">\r\n         <!-- Backdrop -->\r\n         <div class=\"absolute inset-0 bg-black/40 backdrop-blur-sm\" (click)=\"closeTeacherDetails()\"></div>\r\n         \r\n         <!-- Modal Content -->\r\n         <div class=\"relative bg-white rounded-xl shadow-2xl w-[90%] max-w-4xl max-h-[90%] flex flex-col overflow-hidden animate-in fade-in zoom-in duration-200\">\r\n            <!-- Modal Header -->\r\n            <div class=\"p-4 border-b border-gray-100 flex items-center justify-between bg-gray-50\">\r\n               <div>\r\n                  <h3 class=\"font-bold text-gray-800 text-lg\">Giáo viên phụ trách</h3>\r\n                  <p class=\"text-sm text-gray-500\">Học sinh: <span class=\"font-semibold text-blue-600\">{{ viewingStudentDetails.fullName }}</span></p>\r\n               </div>\r\n               <button (click)=\"closeTeacherDetails()\" class=\"p-2 hover:bg-gray-200 rounded-full transition-colors\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"text-gray-500\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>\r\n               </button>\r\n            </div>\r\n\r\n            <!-- Modal Body (Grid of Cards) -->\r\n            <div class=\"p-6 overflow-y-auto bg-gray-50/50\">\r\n               <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                  <div *ngFor=\"let teacher of viewingTeachers\" class=\"bg-white rounded-xl border border-gray-200 shadow-sm p-5 hover:shadow-md transition-shadow relative group\">\r\n                     <!-- Header (Avatar + Name) -->\r\n                     <div class=\"flex items-start gap-4 mb-4\">\r\n                        <img [src]=\"teacher.avatar\" alt=\"Avatar\" class=\"w-12 h-12 rounded-full border border-gray-100 bg-gray-50 object-cover\">\r\n                        <div>\r\n                           <h4 class=\"font-bold text-gray-800 text-base uppercase leading-tight\">{{ teacher.name }}</h4>\r\n                           <span class=\"inline-block mt-1 px-2 py-0.5 bg-green-50 text-green-700 text-[10px] font-bold uppercase rounded border border-green-100\">Đang dạy</span>\r\n                        </div>\r\n                     </div>\r\n                     \r\n                     <!-- Info List -->\r\n                     <div class=\"space-y-3 mb-5\">\r\n                        <div class=\"flex items-center gap-3 text-sm text-gray-600\">\r\n                           <span class=\"w-5 text-center text-gray-400\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect width=\"18\" height=\"18\" x=\"3\" y=\"4\" rx=\"2\" ry=\"2\"/><line x1=\"16\" x2=\"16\" y1=\"2\" y2=\"6\"/><line x1=\"8\" x2=\"8\" y1=\"2\" y2=\"6\"/><line x1=\"3\" x2=\"21\" y1=\"10\" y2=\"10\"/></svg></span>\r\n                           <span>{{ teacher.dob }}</span>\r\n                           <span class=\"bg-blue-50 text-blue-700 px-2 rounded-full text-xs font-medium\">{{ teacher.gender }}</span>\r\n                        </div>\r\n                         <div class=\"flex items-center gap-3 text-sm text-gray-600\">\r\n                           <span class=\"w-5 text-center text-gray-400\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect width=\"20\" height=\"14\" x=\"2\" y=\"5\" rx=\"2\"/><path d=\"M2 10h20\"/><path d=\"M7 15h.01\"/><path d=\"M17 15h.01\"/></svg></span>\r\n                           <span class=\"font-medium text-gray-800\">CCCD: {{ teacher.cccd }}</span>\r\n                        </div>\r\n                        <div class=\"flex items-center gap-3 text-sm text-gray-600\">\r\n                           <span class=\"w-5 text-center text-gray-400\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"/></svg></span>\r\n                           <span>{{ teacher.phone }}</span>\r\n                        </div>\r\n                        <div class=\"flex items-start gap-3 text-sm text-gray-600\">\r\n                           <span class=\"w-5 text-center text-gray-400 mt-0.5\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z\"/><circle cx=\"12\" cy=\"10\" r=\"3\"/></svg></span>\r\n                           <span class=\"text-xs leading-relaxed line-clamp-2\" title=\"{{ teacher.address }}\">{{ teacher.address }}</span>\r\n                        </div>\r\n                     </div>\r\n\r\n                     <!-- Actions -->\r\n                     <div class=\"flex gap-2 mt-auto\">\r\n                        <button class=\"flex-1 flex items-center justify-center gap-2 border border-gray-300 rounded py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors\">\r\n                           <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"/></svg>\r\n                           Gọi điện\r\n                        </button>\r\n                     </div>\r\n                  </div>\r\n               </div>\r\n            </div>\r\n         </div>\r\n      </div>\r\n\r\n    </div>\r\n  `\r\n})\r\nexport class TeacherAssignmentComponent {\r\n  // Use MOCK_STUDENTS direct reference to ensure synchronization across modules\r\n  students: Student[] = MOCK_STUDENTS;\r\n  teachers: Teacher[] = MOCK_TEACHERS;\r\n  \r\n  filteredStudents: Student[] = [];\r\n  filteredTeachers: Teacher[] = [];\r\n  // ... rest of the code remains same, logic for references is updated by removing JSON.parse/stringify ...\r\n\r\n  selectedStudentIds: Set<number> = new Set();\r\n  selectedTeacherIds: Set<number> = new Set();\r\n\r\n  // Filter States\r\n  studentSearchTerm: string = '';\r\n  classFilter: string = '';\r\n  teacherSearchTerm: string = '';\r\n  \r\n  // New state for unassigned filter\r\n  showUnassignedOnly: boolean = false;\r\n\r\n  // If true, applied teacher(s) will set homeroom for selected students\r\n  assignAsHomeroom: boolean = false;\r\n\r\n  // Modal State\r\n  viewingStudentDetails: Student | null = null;\r\n  viewingTeachers: Teacher[] = [];\r\n\r\n  // Toast Notification State\r\n  showToast: boolean = false;\r\n  toastMessage: string = '';\r\n  toastType: 'success' | 'warning' | 'error' = 'success';\r\n  \r\n  constructor(@Inject(ElementRef) private elementRef: ElementRef) {\r\n    this.applyStudentFilters();\r\n    this.filteredTeachers = [...this.teachers];\r\n  }\r\n\r\n  // Helper to show notification\r\n  showNotification(message: string, type: 'success' | 'warning' | 'error' = 'success') {\r\n    this.toastMessage = message;\r\n    this.toastType = type;\r\n    this.showToast = true;\r\n    setTimeout(() => {\r\n        this.showToast = false;\r\n    }, 3000);\r\n  }\r\n\r\n  // Helper to count total unassigned students\r\n  get unassignedCount(): number {\r\n    return this.students.filter(s => !s.assignedTeacherIds || s.assignedTeacherIds.length === 0).length;\r\n  }\r\n\r\n  toggleUnassignedFilter() {\r\n    this.showUnassignedOnly = !this.showUnassignedOnly;\r\n    this.applyStudentFilters();\r\n  }\r\n\r\n  // --- Student Filters ---\r\n  onStudentSearch(event: any) {\r\n    this.studentSearchTerm = event.target.value.toLowerCase();\r\n    this.applyStudentFilters();\r\n  }\r\n\r\n  onClassFilterChange(event: any) {\r\n    this.classFilter = event.target.value;\r\n    this.applyStudentFilters();\r\n  }\r\n\r\n  getClassPriority(className: string): number {\r\n    if (className.includes('Mầm')) return 1;\r\n    if (className.includes('Chồi')) return 2;\r\n    if (className.includes('Lá')) return 3;\r\n    if (className.includes('6-18')) return 4;\r\n    if (className.includes('19-24')) return 5;\r\n    if (className.includes('25-36')) return 6;\r\n    return 99; // Các lớp khác (nếu có)\r\n  }\r\n\r\n  applyStudentFilters() {\r\n    // 1. Filter\r\n    let result = this.students.filter(s => {\r\n      const matchesSearch = s.fullName.toLowerCase().includes(this.studentSearchTerm) || \r\n                            s.code.toLowerCase().includes(this.studentSearchTerm);\r\n      const matchesClass = this.classFilter ? s.className.includes(this.classFilter) : true;\r\n      \r\n      const isUnassigned = !s.assignedTeacherIds || s.assignedTeacherIds.length === 0;\r\n      const matchesUnassigned = this.showUnassignedOnly ? isUnassigned : true;\r\n\r\n      return matchesSearch && matchesClass && matchesUnassigned;\r\n    });\r\n\r\n    // 2. Sort: Mầm -> Chồi -> Lá -> 6-18 -> 19-24 -> 25-36\r\n    result.sort((a, b) => {\r\n      const priorityA = this.getClassPriority(a.className);\r\n      const priorityB = this.getClassPriority(b.className);\r\n\r\n      if (priorityA !== priorityB) {\r\n        return priorityA - priorityB;\r\n      }\r\n      \r\n      return a.className.localeCompare(b.className);\r\n    });\r\n\r\n    this.filteredStudents = result;\r\n  }\r\n\r\n  // --- Teacher Search ---\r\n  onTeacherSearch(event: any) {\r\n    this.teacherSearchTerm = event.target.value.toLowerCase();\r\n    this.filteredTeachers = this.teachers.filter(t => \r\n      t.name.toLowerCase().includes(this.teacherSearchTerm) || \r\n      t.shortName.toLowerCase().includes(this.teacherSearchTerm) ||\r\n      t.cccd.includes(this.teacherSearchTerm)\r\n    );\r\n  }\r\n\r\n  // --- Student Selection Logic ---\r\n  toggleStudent(id: number) {\r\n    if (this.selectedStudentIds.has(id)) {\r\n      this.selectedStudentIds.delete(id);\r\n    } else {\r\n      this.selectedStudentIds.add(id);\r\n    }\r\n  }\r\n\r\n  toggleSelectAll() {\r\n    if (this.isAllSelected()) {\r\n      this.selectedStudentIds.clear();\r\n    } else {\r\n      this.filteredStudents.forEach(s => this.selectedStudentIds.add(s.id));\r\n    }\r\n  }\r\n\r\n  isAllSelected(): boolean {\r\n    return this.filteredStudents.length > 0 && this.selectedStudentIds.size === this.filteredStudents.length;\r\n  }\r\n\r\n  // --- Teacher Selection Logic ---\r\n  toggleTeacherSelection(teacherId: number) {\r\n    if (this.selectedTeacherIds.has(teacherId)) {\r\n      this.selectedTeacherIds.delete(teacherId);\r\n    } else {\r\n      this.selectedTeacherIds.add(teacherId);\r\n    }\r\n  }\r\n\r\n  isTeacherSelected(teacherId: number): boolean {\r\n    return this.selectedTeacherIds.has(teacherId);\r\n  }\r\n\r\n  // --- Main Actions ---\r\n  applyAssignment() {\r\n    if (this.selectedStudentIds.size === 0 || this.selectedTeacherIds.size === 0) return;\r\n\r\n    const teachersToAdd = Array.from(this.selectedTeacherIds);\r\n    // If assigning as homeroom, ensure only one teacher is selected\r\n    if (this.assignAsHomeroom && teachersToAdd.length > 1) {\r\n      this.showNotification('Chỉ có thể chọn 1 giáo viên làm chủ nhiệm. Vui lòng chọn 1 giáo viên.', 'warning');\r\n      return;\r\n    }\r\n    let countSuccess = 0;\r\n\r\n    this.students.forEach(student => {\r\n      if (this.selectedStudentIds.has(student.id)) {\r\n        if (!student.assignedTeacherIds) student.assignedTeacherIds = [];\r\n        \r\n        let added = false;\r\n        for (const newId of teachersToAdd) {\r\n          // If not assigning as homeroom and the teacher is already the student's homeroom, warn and skip\r\n          if (!this.assignAsHomeroom && student.homeroomTeacherId && newId === student.homeroomTeacherId) {\r\n            const teacher = this.teachers.find(t => t.id === newId);\r\n            if (teacher) {\r\n              this.showNotification(`Giáo viên ${teacher.shortName} đã được phân làm giáo viên chủ nhiệm cho học sinh ${student.fullName}.`, 'warning');\r\n            }\r\n            continue;\r\n          }\r\n\r\n          if (!student.assignedTeacherIds!.includes(newId)) {\r\n            student.assignedTeacherIds!.push(newId);\r\n            added = true;\r\n          }\r\n        }\r\n\r\n        // If assigning as homeroom, set homeroomTeacherId to the first selected teacher\r\n        if (this.assignAsHomeroom && teachersToAdd.length > 0) {\r\n          // pick first selected teacher as homeroom\r\n          student.homeroomTeacherId = teachersToAdd[0];\r\n          // ensure homeroom teacher is included in assignedTeacherIds\r\n          if (!student.assignedTeacherIds.includes(teachersToAdd[0])) {\r\n            student.assignedTeacherIds.push(teachersToAdd[0]);\r\n            added = true;\r\n          }\r\n        }\r\n\r\n        if (added) countSuccess++;\r\n      }\r\n    });\r\n\r\n    this.applyStudentFilters(); // Refresh UI\r\n    this.selectedTeacherIds.clear(); // Reset Teacher checkboxes\r\n    this.selectedStudentIds.clear(); // Reset Student checkboxes\r\n    // Reset the homeroom assignment toggle after applying\r\n    this.assignAsHomeroom = false;\r\n\r\n    this.showNotification(`Đã phân công thành công cho ${countSuccess} học sinh!`, 'success');\r\n  }\r\n\r\n  removeAssignment() {\r\n     if (this.selectedStudentIds.size === 0 || this.selectedTeacherIds.size === 0) return;\r\n\r\n     const teachersToRemove = Array.from(this.selectedTeacherIds);\r\n     let changeCount = 0;\r\n\r\n     this.students.forEach(student => {\r\n       if (this.selectedStudentIds.has(student.id) && student.assignedTeacherIds) {\r\n          const originalLength = student.assignedTeacherIds.length;\r\n          student.assignedTeacherIds = student.assignedTeacherIds.filter(\r\n            existingId => !teachersToRemove.includes(existingId)\r\n          );\r\n          // If homeroom teacher removed, clear homeroomTeacherId\r\n          if (student.homeroomTeacherId && teachersToRemove.includes(student.homeroomTeacherId)) {\r\n            student.homeroomTeacherId = undefined;\r\n          }\r\n          if (student.assignedTeacherIds.length !== originalLength) {\r\n             changeCount++;\r\n          }\r\n       }\r\n     });\r\n\r\n    if (changeCount === 0) {\r\n       this.showNotification('Các học sinh đã chọn chưa được phân công bởi giáo viên này.', 'warning');\r\n       return;\r\n    }\r\n\r\n    this.applyStudentFilters(); // Refresh UI\r\n    this.selectedTeacherIds.clear(); // Reset Teacher checkboxes\r\n    this.selectedStudentIds.clear(); // Reset Student checkboxes\r\n\r\n    this.showNotification(`Đã gỡ phân công thành công cho ${changeCount} học sinh.`, 'success');\r\n  }\r\n\r\n  // --- Helpers ---\r\n  getAssignedTeachers(student: Student): Teacher[] {\r\n    if (!student.assignedTeacherIds) return [];\r\n    return this.teachers.filter(t => student.assignedTeacherIds!.includes(t.id));\r\n  }\r\n\r\n  // --- Details Modal Logic ---\r\n  openTeacherDetails(student: Student) {\r\n    const assigned = this.getAssignedTeachers(student);\r\n    if (assigned.length === 0) return;\r\n    \r\n    this.viewingStudentDetails = student;\r\n    this.viewingTeachers = assigned;\r\n  }\r\n\r\n  closeTeacherDetails() {\r\n    this.viewingStudentDetails = null;\r\n    this.viewingTeachers = [];\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}